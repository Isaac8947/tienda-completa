<!DOCTYPE html>
<html>
<head>
    <title>Test Reviews API</title>
</head>
<body>
    <h1>Test Reviews API</h1>
    
    <h2>Debug Info</h2>
    <iframe src="api/reviews/debug.php" width="100%" height="400" style="border: 1px solid #ccc;"></iframe>
    
    <h2>Test Form</h2>
    <form id="testForm">
        <p><strong>Product ID:</strong> <input type="number" name="product_id" value="14" required></p>
        <p><strong>Rating:</strong> <input type="number" name="rating" value="5" min="1" max="5" required></p>
        <p><strong>Title:</strong> <input type="text" name="title" value="Test Review" required></p>
        <p><strong>Comment:</strong> <textarea name="comment" required>Esta es una reseña de prueba</textarea></p>
        <p><button type="submit">Enviar Reseña</button></p>
    </form>
    
    <h2>Response</h2>
    <div id="response" style="background: #f5f5f5; padding: 10px; border: 1px solid #ddd;"></div>
    
    <script>
    document.getElementById('testForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const formData = new FormData(e.target);
        const responseDiv = document.getElementById('response');
        
        try {
            responseDiv.innerHTML = 'Enviando...';
            
            const response = await fetch('api/reviews/create.php', {
                method: 'POST',
                body: formData
            });
            
            const text = await response.text();
            let result;
            
            try {
                result = JSON.parse(text);
            } catch {
                result = { raw: text };
            }
            
            responseDiv.innerHTML = `
                <p><strong>Status:</strong> ${response.status}</p>
                <p><strong>Response:</strong></p>
                <pre>${JSON.stringify(result, null, 2)}</pre>
                ${result.raw ? `<p><strong>Raw Response:</strong></p><pre>${result.raw}</pre>` : ''}
            `;
            
        } catch (error) {
            responseDiv.innerHTML = `<p><strong>Error:</strong> ${error.message}</p>`;
        }
    });
    </script>
</body>
</html>
